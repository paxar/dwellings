/*!  1.4.16 2017-05-02 16:17 */
CHARITABLE_ADMIN=window.CHARITABLE_ADMIN||{},function(a,b){if(b.fn.datepicker){var c=function(a){this.$el=a,options={dateFormat:"MM d, yy",minDate:this.$el.data("min-date")||"",beforeShow:function(a,c){b("#ui-datepicker-div").addClass("charitable-datepicker-table")}},this.$el.datepicker(options),this.$el.data("date")&&this.$el.datepicker("setDate",this.$el.data("date")),this.$el.data("min-date")&&this.$el.datepicker("option","minDate",this.$el.data("min-date"))};a.Datepicker=c}}(CHARITABLE_ADMIN,jQuery),function(a,b){var c=function(a){var c=[];show_setting=function(a,b){return"checked"===a?b.is(":checked"):"selected"===a?b.selected():b.val()===a},toggle_setting=function(a,b){var c=a.parents("tr").first(),d=get_setting_value(a);c.toggle(show_setting(d,b))},get_setting_value=function(a){var b=a.data("trigger-value");return"undefined"==typeof b&&(b=a.data("show-only-if-value")),b},toggle_options=function(a,c){var d,e=c.val(),f=a.data("trigger-value");("radio"!==c.attr("type")||c.prop("checked"))&&f.hasOwnProperty(e)&&(d=f[e],a.find("input").each(function(){var a=b(this),c=!(a.val()in d);c&&a.prop("checked",!1),a.prop("disabled",c).trigger("change")}))},get_trigger_id=function(a){var b=a.data("trigger-key");return"undefined"==typeof b&&(b="#"+a.data("show-only-if-key")),b},get_trigger=function(a){return b("#"===a[0]?a:"[name="+a+"]")},get_change_type=function(a){var b=a.data("trigger-change-type");return"undefined"==typeof b&&(b="visibility"),b},on_change=function(){var a=b(this),d=a.data("trigger_idx");for(idx in d)if(d.hasOwnProperty(idx)){settings=c[idx].settings;for(setting_key in settings)if(settings.hasOwnProperty(setting_key)){var e=settings[setting_key],f=get_change_type(e);"visibility"===f?toggle_setting(e,a):"options"===f&&toggle_options(e,a)}}},this.$el=a;var d=0;this.$el.find("[data-trigger-key],[data-show-only-if-key]").each(function(){var a=b(this),e=get_trigger_id(a);c[e];"undefined"==typeof c[e]&&(c[d]={trigger_id:e,settings:[]}),c[d].settings.push(a),d+=1});for(d in c)if(c.hasOwnProperty(d)){var e=get_trigger(c[d].trigger_id),f=e.data("trigger_idx");"undefined"==typeof f&&(f=[]),f.push(d),e.data("trigger_idx",f),e.on("change",on_change),e.trigger("change")}};a.Settings=c}(CHARITABLE_ADMIN,jQuery),function(a){var b=function(){a("[data-charitable-action]").on("click",function(b){var c=a(this).data("charitable-args")||{},d="charitable-"+a(this).data("charitable-action");return a.post(ajaxurl,{action:d,data:c},function(a){console.log("Response: "+a)}),!1})},c=function(){a("[data-charitable-toggle]").on("click",function(b){var c=a(this).data("charitable-toggle"),d=a(this).attr("data-charitable-toggle-text");return d&&d.length&&(a(this).attr("data-charitable-toggle-text",a(this).text()),a(this).text(d)),a("#"+c).toggle(),!1})},d=function(){var b=a("#charitable-campaign-advanced-metabox");b.tabs();var c=b.find(".charitable-tabs").height();b.find(".ui-tabs-panel").each(function(){a(this).css("min-height",c)})},e=function(){var b=a("#campaign_allow_custom_donations"),c=a(".charitable-campaign-suggested-donations tbody tr:not(.to-copy)"),d=c.length>1||!1===c.first().hasClass("no-suggested-amounts");b.prop("disabled",!d),d||b.prop("checked",!0)},f=function(){a(".charitable-campaign-suggested-donations tbody").sortable({items:"tr:not(.to-copy)",handle:".handle",stop:function(a,b){i()}})},g=function(a){var b=a.closest(".charitable-campaign-suggested-donations").find("tbody"),c=b.find("tr.to-copy").clone().removeClass("to-copy hidden");b.find(".no-suggested-amounts").hide(),b.append(c),i(),e()},h=function(a){console.log(a),a.closest("tr").remove();var b=a.closest(".charitable-campaign-suggested-donations").find("tbody");1==b.find("tr:not(.to-copy)").length&&b.find(".no-suggested-amounts").removeClass("hidden").show(),i(),e()},i=function(){a(".charitable-campaign-suggested-donations tbody").each(function(){a(this).children("tr").not(".no-suggested-amounts .to-copy").each(function(b){a(this).data("index",b),a(this).find("input").each(function(a){this.name=this.name.replace(/(\[\d\])/,"["+b+"]")})})})},j=function(){var b=a("#charitable_dashboard_donations");b.length&&a.ajax({type:"GET",data:{action:"charitable_load_dashboard_donations_widget"},url:ajaxurl,success:function(a){b.find(".inside").html(a)}})};a(document).ready(function(){CHARITABLE_ADMIN.Datepicker&&a(".charitable-datepicker").each(function(){CHARITABLE_ADMIN.Datepicker(a(this))}),a("#charitable-settings, body.post-type-campaign form#post").each(function(){CHARITABLE_ADMIN.Settings(a(this))}),a("body.post-type-campaign .handlediv, body.post-type-donation .handlediv").remove(),a("body.post-type-campaign .hndle, body.post-type-donation .hndle").removeClass("hndle ui-sortable-handle").addClass("postbox-title"),d(),f(),e(),b(),c(),j(),a("[data-charitable-add-row]").on("click",function(){var b=a(this).data("charitable-add-row");return"suggested-amount"===b&&g(a(this)),!1}),a(".charitable-campaign-suggested-donations").on("click",".charitable-delete-row",function(){return console.log("clicked"),h(a(this)),!1}),a("body").on("click","[data-campaign-benefactor-delete]",function(){var b=a(this).parents(".charitable-benefactor"),c={action:"charitable_delete_benefactor",benefactor_id:a(this).data("campaign-benefactor-delete"),nonce:a(this).data("nonce")};return a.ajax({type:"POST",data:c,dataType:"json",url:ajaxurl,xhrFields:{withCredentials:!0},success:function(a){a.deleted&&b.remove()}}).fail(function(a){window.console&&window.console.log&&(console.log("failture"),console.log(a))}),!1}),a("#change-donation-status").on("change",function(){a(this).parents("form").submit()})})}(jQuery);