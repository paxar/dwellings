!function(a){var b,c,d=StripeCheckout.configure({key:CHARITABLE_STRIPE_VARS.key,image:"",locale:"auto",token:function(c){a("#charitable-donation-form [name=stripe_token]").val(c.id),a("body").off("submit","#charitable-donation-form-modal-loop #charitable-donation-form[data-use-ajax=1]",f),b.attr("data-use-ajax",1).trigger("submit"),a("body").on("submit","#charitable-donation-form-modal-loop #charitable-donation-form[data-use-ajax=1]",f)}}),e=function(a){"stripe"===new CHARITABLE.Donation_Form(a).get_payment_method()&&a.attr("data-use-ajax",0)},f=function(b){return b.stopImmediatePropagation(),e(a(this)),a("body").off("submit","#charitable-donation-form-modal-loop #charitable-donation-form[data-use-ajax=1]",f),a(this).trigger("submit"),a("body").on("submit","#charitable-donation-form-modal-loop #charitable-donation-form[data-use-ajax=1]",f),!1};a("body").on("submit","#charitable-donation-form-modal-loop #charitable-donation-form[data-use-ajax=1]",f),a("body").on("submit","#charitable-donation-form[data-use-ajax=0]",function(e){if(b=a(this),c=new CHARITABLE.Donation_Form(b),"stripe"!==c.get_payment_method())return!0;if(c.validate()){var f=100*c.get_amount();d.open({name:CHARITABLE_STRIPE_VARS.site_name,description:c.get_description(),email:c.get_email(),currency:CHARITABLE_STRIPE_VARS.currency,amount:f})}else alert(c.get_error_message());e.preventDefault()}),a("body").on("change","#charitable-gateway-selector input[name=gateway]",function(){e(a(this).parents("#charitable-donation-form"))}),a(document).ready(function(){var b=a("#charitable-donation-form");b.length&&e(b),a("#charitable-gateway-selector input[name=gateway]").trigger("change")}),a(window).on("popstate",function(){d.close()})}(jQuery);